<div class="dashboard-view">
    <!-- Toggle Header -->
    <div class="dashboard-toggle-header">
        <div class="dashboard-toggle" id="dashboardToggle">
            <div class="dashboard-toggle-indicator"></div>
            <button class="dashboard-toggle-btn active" data-panel="execution" onclick="switchDashboardPanel('execution')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
                Exécution
            </button>
            <button class="dashboard-toggle-btn" data-panel="edition" onclick="switchDashboardPanel('edition')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
                Édition
            </button>
            <button class="dashboard-toggle-btn" data-panel="mapping" onclick="switchDashboardPanel('mapping')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="5" cy="6" r="3"/>
                    <circle cx="19" cy="6" r="3"/>
                    <circle cx="5" cy="18" r="3"/>
                    <circle cx="19" cy="18" r="3"/>
                    <path d="M8 6h8M8 18h8M5 9v6M19 9v6"/>
                </svg>
                Mapping
            </button>
        </div>
    </div>
    
    <!-- Sliding Container -->
    <div class="dashboard-slider">
        <div class="dashboard-slider-track" id="dashboardSliderTrack">
            
            <!-- ============================================
                 EXECUTION PANEL
                 ============================================ -->
            <div class="dashboard-panel">
                <div class="execution-panel">
                    <!-- Scripts List -->
                    <div class="execution-scripts">
                        <div class="execution-scripts-header">
                            <h3>Scripts disponibles</h3>
                            <span class="execution-scripts-count" id="scriptsCount">0 script(s)</span>
                        </div>
                        <div id="scriptsList">
                            <div class="scripts-loading">Chargement des scripts...</div>
                        </div>
                    </div>
                    
                    <!-- Console -->
                    <div class="execution-console">
                        <div class="execution-console-header">
                            <h4>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="4 17 10 11 4 5"/>
                                    <line x1="12" y1="19" x2="20" y2="19"/>
                                </svg>
                                Console
                            </h4>
                            <button class="console-clear-btn" onclick="clearConsole()">Effacer</button>
                        </div>
                        <div class="execution-console-content" id="consoleContent">
                            <div class="console-line">
                                <span class="console-time">[--:--:--]</span>
                                <span class="console-message">Prêt. Sélectionnez un script à exécuter.</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ============================================
                 EDITION PANEL
                 ============================================ -->
            <div class="dashboard-panel">
                <div class="edition-panel">
                    
                    <!-- Blocks Palette -->
                    <aside class="edition-palette">
                        <div class="edition-palette-header">
                            <h3>Blocs</h3>
                        </div>
                        <div class="edition-palette-search">
                            <input type="text" placeholder="Rechercher..." id="paletteSearch">
                        </div>
                        <div class="edition-palette-blocks" id="paletteBlocks">
                            
                            <!-- Section Block -->
                            <div class="palette-block" draggable="true" data-block-type="section" style="--block-color: #8b5cf6;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M4 6h16M4 12h16M4 18h7"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Section</div>
                                    <div class="palette-block-desc">Conteneur hiérarchique</div>
                                </div>
                            </div>
                            
                            <!-- Text Block -->
                            <div class="palette-block" draggable="true" data-block-type="text" style="--block-color: #64748b;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                        <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Texte</div>
                                    <div class="palette-block-desc">Paragraphe</div>
                                </div>
                            </div>
                            
                            <!-- Callout Block -->
                            <div class="palette-block" draggable="true" data-block-type="callout" style="--block-color: #f59e0b;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"/>
                                        <line x1="12" y1="8" x2="12" y2="12"/>
                                        <line x1="12" y1="16" x2="12.01" y2="16"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Callout</div>
                                    <div class="palette-block-desc">Encadré</div>
                                </div>
                            </div>
                            
                            <!-- Metrics Block -->
                            <div class="palette-block" draggable="true" data-block-type="metrics" style="--block-color: #22c55e;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="3" width="7" height="7"/>
                                        <rect x="14" y="3" width="7" height="7"/>
                                        <rect x="14" y="14" width="7" height="7"/>
                                        <rect x="3" y="14" width="7" height="7"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Métriques</div>
                                    <div class="palette-block-desc">Cartes KPI</div>
                                </div>
                            </div>
                            
                            <!-- Table Block -->
                            <div class="palette-block" draggable="true" data-block-type="table" style="--block-color: #06b6d4;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                        <line x1="3" y1="9" x2="21" y2="9"/>
                                        <line x1="3" y1="15" x2="21" y2="15"/>
                                        <line x1="9" y1="3" x2="9" y2="21"/>
                                        <line x1="15" y1="3" x2="15" y2="21"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Tableau</div>
                                    <div class="palette-block-desc">Données</div>
                                </div>
                            </div>
                            
                            <!-- Line Plot Block -->
                            <div class="palette-block" draggable="true" data-block-type="lineplot" style="--block-color: #6366f1;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Line Plot</div>
                                    <div class="palette-block-desc">Graphique ligne</div>
                                </div>
                            </div>
                            
                            <!-- Scatter Plot Block -->
                            <div class="palette-block" draggable="true" data-block-type="scatter" style="--block-color: #ec4899;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="7.5" cy="7.5" r="2"/>
                                        <circle cx="16.5" cy="7.5" r="2"/>
                                        <circle cx="7.5" cy="16.5" r="2"/>
                                        <circle cx="16.5" cy="16.5" r="2"/>
                                        <circle cx="12" cy="12" r="2"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Scatter</div>
                                    <div class="palette-block-desc">Nuage de points</div>
                                </div>
                            </div>
                            
                            <!-- Histogram Block -->
                            <div class="palette-block" draggable="true" data-block-type="histogram" style="--block-color: #14b8a6;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="12" width="4" height="9"/>
                                        <rect x="10" y="6" width="4" height="15"/>
                                        <rect x="17" y="9" width="4" height="12"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Histogram</div>
                                    <div class="palette-block-desc">Distribution</div>
                                </div>
                            </div>
                            
                            <!-- Stats Block -->
                            <div class="palette-block" draggable="true" data-block-type="stats" style="--block-color: #a855f7;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 20V10M12 20V4M6 20v-6"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Stats</div>
                                    <div class="palette-block-desc">Statistiques</div>
                                </div>
                            </div>
                            
                            <!-- LaTeX Block -->
                            <div class="palette-block" draggable="true" data-block-type="latex" style="--block-color: #78716c;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <text x="4" y="17" font-size="14" font-family="serif" fill="currentColor">∑</text>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">LaTeX</div>
                                    <div class="palette-block-desc">Formule math</div>
                                </div>
                            </div>
                            
                            <!-- Code Block -->
                            <div class="palette-block" draggable="true" data-block-type="code" style="--block-color: #334155;">
                                <div class="palette-block-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="16 18 22 12 16 6"/>
                                        <polyline points="8 6 2 12 8 18"/>
                                    </svg>
                                </div>
                                <div class="palette-block-info">
                                    <div class="palette-block-name">Code</div>
                                    <div class="palette-block-desc">Python custom</div>
                                </div>
                            </div>
                            
                        </div>
                    </aside>
                    
                    <!-- Canvas -->
                    <div class="edition-canvas-container">
                        <div class="edition-canvas-toolbar">
                            <div class="edition-canvas-toolbar-left">
                                <div class="edition-script-name">
                                    <input type="text" value="Nouveau Script" id="currentScriptName">
                                </div>
                                <span class="script-status-indicator" id="scriptStatus">Nouveau</span>
                            </div>
                            <div class="edition-canvas-toolbar-right">
                                <button class="edition-toolbar-btn secondary" data-toolbar-action="new">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                        <polyline points="14 2 14 8 20 8"/>
                                        <line x1="12" y1="18" x2="12" y2="12"/>
                                        <line x1="9" y1="15" x2="15" y2="15"/>
                                    </svg>
                                    Nouveau
                                </button>
                                <button class="edition-toolbar-btn primary" data-toolbar-action="save">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                                        <polyline points="17 21 17 13 7 13 7 21"/>
                                        <polyline points="7 3 7 8 15 8"/>
                                    </svg>
                                    Sauvegarder
                                </button>
                                <button class="edition-toolbar-btn success" data-toolbar-action="save-run">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polygon points="5 3 19 12 5 21 5 3"/>
                                    </svg>
                                    Exécuter
                                </button>
                            </div>
                        </div>
                        
                        <div class="edition-canvas" id="editionCanvas">
                            <!-- Empty state -->
                            <div class="edition-canvas-empty" id="canvasEmpty">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <line x1="12" y1="8" x2="12" y2="16"/>
                                    <line x1="8" y1="12" x2="16" y2="12"/>
                                </svg>
                                <h3>Glissez des blocs ici</h3>
                                <p>Construisez votre rapport en ajoutant des blocs depuis la palette</p>
                            </div>
                            
                            <!-- Blocks container -->
                            <div class="edition-canvas-blocks" id="canvasBlocks" style="display: none;">
                                <!-- Canvas blocks rendered by JS -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Outline Panel -->
                    <aside class="edition-outline">
                        <div class="edition-outline-header">
                            <h3>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="21" y1="10" x2="3" y2="10"/>
                                    <line x1="21" y1="6" x2="3" y2="6"/>
                                    <line x1="21" y1="14" x2="3" y2="14"/>
                                    <line x1="21" y1="18" x2="3" y2="18"/>
                                </svg>
                                Outline
                            </h3>
                            <div class="outline-actions">
                                <button class="outline-action-btn" data-toolbar-action="expand-all" title="Tout déplier">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="7 13 12 18 17 13"/>
                                        <polyline points="7 6 12 11 17 6"/>
                                    </svg>
                                </button>
                                <button class="outline-action-btn" data-toolbar-action="collapse-all" title="Tout replier">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="17 11 12 6 7 11"/>
                                        <polyline points="17 18 12 13 7 18"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="edition-outline-content" id="outlineContent">
                            <div class="outline-empty">
                                <p>Ajoutez des blocs Section pour voir la structure</p>
                            </div>
                        </div>
                    </aside>
                    
                </div>
            </div>
            
            <!-- ============================================
                 MAPPING PANEL
                 ============================================ -->
            <div class="dashboard-panel">
                <div class="mapping-panel">
                    <div class="mapping-header">
                        <div class="mapping-header-left">
                            <h2>Signal Mapping</h2>
                            <p>Définissez les correspondances entre les noms internes et les signaux sources</p>
                        </div>
                        <div class="mapping-header-right">
                            <button class="mapping-btn secondary" onclick="importMappings()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                                Importer
                            </button>
                            <button class="mapping-btn secondary" onclick="exportMappings()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="17 8 12 3 7 8"/>
                                    <line x1="12" y1="3" x2="12" y2="15"/>
                                </svg>
                                Exporter
                            </button>
                            <button class="mapping-btn primary" onclick="addMappingVariable()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                Nouvelle variable
                            </button>
                        </div>
                    </div>
                    
                    <div class="mapping-toolbar">
                        <div class="mapping-search">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="M21 21l-4.35-4.35"/>
                            </svg>
                            <input type="text" placeholder="Rechercher une variable..." id="mappingSearch">
                        </div>
                        <div class="mapping-stats">
                            <span id="mappingCount">0 variable(s)</span>
                        </div>
                    </div>
                    
                    <div class="mapping-list" id="mappingList">
                        <div class="mapping-empty" id="mappingEmpty">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <circle cx="5" cy="6" r="3"/>
                                <circle cx="19" cy="6" r="3"/>
                                <circle cx="5" cy="18" r="3"/>
                                <circle cx="19" cy="18" r="3"/>
                                <path d="M8 6h8M8 18h8M5 9v6M19 9v6"/>
                            </svg>
                            <h3>Aucun mapping défini</h3>
                            <p>Créez des variables internes et associez-leur des signaux sources</p>
                            <button class="mapping-btn primary" onclick="addMappingVariable()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                Créer une variable
                            </button>
                        </div>
                        
                        <div class="mapping-items" id="mappingItems" style="display: none;">
                            <!-- Mapping items rendered by JS -->
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
</div>